<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
"http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd" [

  <!ENTITY dhfirstname "<firstname>Petr</firstname>">
  <!ENTITY dhsurname   "<surname>Kubanek</surname>">
  <!ENTITY dhdate      "<date>2011-01-28</date>">
  <!ENTITY dhsection   "<manvolnum>7</manvolnum>">
  <!ENTITY dhemail     "<email>petr@kubanek.net</email>">
  <!ENTITY dhusername  "Petr Kubanek">
  <!ENTITY dhpackage   "rts2-selector">

  <!ENTITY % rts2 SYSTEM "rts2.ent">
  %rts2;
]>

<refentry>
  <refentryinfo>
    <title>&dhpackage;</title>
    <productname>rts2</productname>
    <productnumber>&rts2version;</productnumber>
    &dhdate;
    <authorgroup>
      <author>
        &dhfirstname;
        &dhsurname;
	<contrib>Wrote this manual page.</contrib>
	<address>
          &dhemail;
	</address>
      </author>
    </authorgroup>
    <copyright>
      <year>2011</year>
      <holder>&fzu;</holder>
    </copyright>
    &legal;
  </refentryinfo>
  <refmeta>
    <refentrytitle>&dhpackage;</refentrytitle>
    &dhsection;
  </refmeta>
  <refnamediv>
    <refname>&dhpackage;</refname>
    <refpurpose>
      Component responsible for selecting next observations. It either select
      next observations from user supplied and filled queues, from plan entries
      loaded from the database, or selected autonomously from available targets.
    </refpurpose>
  </refnamediv>
  <refsynopsisdiv>
    <cmdsynopsis>
      <command>&dhpackage;</command>
      <arg rep='repeat'><option>--add-queue</option> <replaceable class='parameter'>queue name</replaceable></arg>
      <arg rep='repeat'><option>--filter-aliases</option> <replaceable class='parameter'>filter aliases file</replaceable></arg>
      <arg rep='repeat'><option>--filter-file</option> <replaceable class='parameter'>camera</replaceable>:<replaceable class='parameter'>filter file</replaceable></arg>
      <arg><option>--available-filters</option> <replaceable class='parameter'>camera</replaceable> <replaceable class='parameter'>filters</replaceable></arg>
      &deviceappdb;
    </cmdsynopsis>
    <cmdsynopsis>
      <command>&dhpackage;</command>
      &help;
    </cmdsynopsis>  

  </refsynopsisdiv>

  <refsect1 id="description">
    <title>DESCRIPTION</title>

    <para>
      <command>&dhpackage;</command> is a RTS2 component, which provides
      target selection services to the
      <citerefentry><refentrytitle>rts2-executor</refentrytitle><manvolnum>7</manvolnum></citerefentry>.
      It suggest which targets shoudl be observed. It is up to
      <command>rts2-executor</command> (or a script running observations) to
      take those suggestions into account and observe targets the selector
      suggests.
    </para>
    <para>
      The <command>&dhpackage;</command> can select next observations from those sources:
    </para>
    <variablelist>
      <varlistentry>
         <term>queues</term>
	 <listitem>
	   <para>
	     User named list of observations targets. Queues holds a list of
	     targets, and select among those targets from various criteria. More is described in
	     <citerefentry><refentrytitle>rts2.queues</refentrytitle><manvolnum>5</manvolnum></citerefentry>.
	   </para>
	   <para>
	     Plan entries, e.g. observations which should be observed on given
	     time, can be loaded to the queue. Planned observations are special
	     case of queue selection. Please see
	     <citerefentry><refentrytitle>rts2-plan</refentrytitle><manvolnum>1</manvolnum></citerefentry>
	     for description of plan entries management tool.
	   </para>
	   <para>
	     Entries from queues are executed iregardless if the target is
	     enabled or not. This allows observers to specify what they exactly
	     want to observe, and do not worry about details that the target is
	     currently disabled, have low priority or does not fit some
	     constraints.
	   </para>
	 </listitem>
      </varlistentry>
      <varlistentry>	 
	 <term>priority based selection</term>
	 <listitem>
	   <para>
	     This selection runs the autonomous selection. It select among
	     eneabled targets. The best target is selected as next target. The
	     best target is target which have highest bonus parameter. Please
	     see
	     <citerefentry><refentrytitle>rts2-targetinfo</refentrytitle><manvolnum>1</manvolnum></citerefentry>
	     for details how to obtain target bonus.
	   </para>
	 </listitem>
      </varlistentry>
    </variablelist>
  </refsect1>
  <refsect1>
    <title>Operation</title>
  </refsect1>
  <refsect1>
    <title>Variables</title>
    <para>
      <command>&dhpackage;</command> exposes to system following variables.
    </para>  
    <variablelist>
      &infotime;
      <varlistentry>
        <term>next_id</term>
	<listitem>
	  <para>
	    ID of next target which should be observed. This is the target
	    <command>&dhpackage;</command> suggest for selection.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
        <term>next_plan_id</term>
	<listitem>
	  <para>
	    If next target is taken from the scheduler plan, containts its plan
	    ID. Please see
	    <citerefentry><refentrytitle>rts2-plan</refentrytitle><manvolnum>1</manvolnum></citerefentry>
	    for details on plan management.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
        <term>next_time</term>
	<listitem>
	  <para>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
        <term>interrupt</term>
	<listitem>
	  <para>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
        <term>idle_select</term>
	<listitem>
	  <para>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
        <term>night_idle_select</term>
	<listitem>
	  <para>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
        <term>selector_enabled</term>
	<listitem>
	  <para>
	    Enables selection of the next targets. If false, selector will not
	    send next target IDs to executor.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
        <term>flat_sun_min</term>
	<listitem>
	  <para>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
        <term>flat_sun_max</term>
	<listitem>
	  <para>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
        <term>night_disable_type</term>
	<listitem>
	  <para>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
        <term>selector_queue</term>
	<listitem>
	  <para>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
        <term>last_queue</term>
	<listitem>
	  <para>
	  </para>
	</listitem>
      </varlistentry>
    </variablelist>  
  </refsect1>
  <refsect1>
    <title>OPTIONS</title>

    &optiongnu;

    <variablelist>
      <varlistentry>
        <term><option>--add-queue</option> <replaceable class='parameter'>queue name</replaceable></term>
        <listitem>
          <para>
	    Adds user queues. The queues are preffered way for user
	    interactions with the system.
	  </para>
        </listitem>
      </varlistentry>
      &selectorlist;
      &deviceappdblist;
    </variablelist>
  </refsect1> 
  <refsect1>
    <title>SEE ALSO</title>

    <para>
      <citerefentry>
        <refentrytitle>rts2</refentrytitle>
	<manvolnum>1</manvolnum>
      </citerefentry>
      <citerefentry>
        <refentrytitle>rts2.ini</refentrytitle>
	<manvolnum>5</manvolnum>
      </citerefentry>
      <citerefentry>
        <refentrytitle>rts2-plan</refentrytitle>
	<manvolnum>1</manvolnum>
      </citerefentry>
      <citerefentry>
        <refentrytitle>rts2.queues</refentrytitle>
	<manvolnum>5</manvolnum>
      </citerefentry>
    </para>

  </refsect1>
</refentry>
